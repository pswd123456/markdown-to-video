# Smart Learning: Markdown to Video (æ™ºèƒ½ Manim è§†é¢‘ç”Ÿæˆå™¨)

è¿™æ˜¯ä¸€ä¸ªæ™ºèƒ½åŒ–çš„è‡ªåŠ¨åŒ–ç³»ç»Ÿï¼Œèƒ½å¤Ÿåˆ©ç”¨ [Manim](https://www.manim.community/) å’Œå¤§è¯­è¨€æ¨¡å‹ (LLMs) å°†æ•™è‚²æ–‡æœ¬è„šæœ¬è½¬åŒ–ä¸ºä¸“ä¸šçº§çš„åŠ¨ç”»è§†é¢‘ã€‚

æœ¬é¡¹ç›®ç”± **LangGraph** é©±åŠ¨ï¼Œé‡‡ç”¨å…·å¤‡è‡ªæˆ‘ä¿®æ­£èƒ½åŠ›çš„â€œAgenticâ€å·¥ä½œæµï¼Œæ¨¡æ‹Ÿäº†çœŸå®çš„åŠ¨ç”»å·¥ä½œå®¤æµæ°´çº¿â€”â€”åŒ…å«å¯¼æ¼” (è§„åˆ’å™¨)ã€åŠ¨ç”»å¸ˆ (ç¼–ç å™¨)ã€å®¡æ ¸å‘˜ (æ‰¹è¯„å®¶) å’ŒæŠ€æœ¯ä¸»ç®¡ (ä¿®å¤å™¨)ã€‚

## ğŸš€ æ ¸å¿ƒåŠŸèƒ½

*   **è„šæœ¬é‡å†™å™¨ (Script Rewriter)**ï¼šè‡ªåŠ¨å°†åŸå§‹æ–‡æœ¬è‰ç¨¿è½¬åŒ–ä¸ºç»“æ„åŒ–çš„åˆ†é•œè„šæœ¬ (JSON æ ¼å¼)ã€‚
*   **å¤šæ™ºèƒ½ä½“å·¥ä½œæµ (Multi-Agent Workflow)**ï¼š
    *   **ğŸ§  è§„åˆ’å™¨ (Planner)**ï¼šåœ¨å†™ä»£ç ä¹‹å‰ï¼Œå…ˆåˆ†æåœºæ™¯éœ€æ±‚å¹¶è®¾è®¡ç©ºé—´å¸ƒå±€ç­–ç•¥ã€‚
    *   **ğŸ‘¨â€ğŸ’» ç¼–ç å™¨ (Coder)**ï¼šå°†è§„åˆ’è½¬åŒ–ä¸ºå¯æ‰§è¡Œçš„ Manim (Python) ä»£ç ã€‚
    *   **ğŸ‘€ è§†è§‰æ‰¹è¯„å®¶ (Vision Critic)**ï¼šä½¿ç”¨å¤šæ¨¡æ€å¤§æ¨¡å‹ (å¦‚ Qwen-VL) æ£€æŸ¥æ¸²æŸ“å‡ºçš„ç”»é¢ï¼Œå‘ç°è§†è§‰ç¼ºé™· (å¦‚é®æŒ¡ã€æˆªæ–­ã€æ¸…æ™°åº¦é—®é¢˜) å¹¶é©³å›ä½è´¨é‡ç»“æœã€‚
    *   **ğŸ”§ ä¿®å¤å™¨ (Fixer)**ï¼šä¸“é—¨çš„æ™ºèƒ½ä½“ï¼Œè´Ÿè´£åˆ†æè¿è¡Œæ—¶é”™è¯¯æˆ–è§†è§‰åé¦ˆï¼Œå¹¶ç”Ÿæˆç²¾ç¡®çš„ä¿®å¤æŒ‡ä»¤ã€‚
*   **Docker æ¸²æŸ“**: åœ¨éš”ç¦»çš„ Docker ç¯å¢ƒä¸­å®‰å…¨æ‰§è¡Œç”Ÿæˆçš„ä»£ç ï¼Œé˜²æ­¢å¯¹å®¿ä¸»ç³»ç»Ÿé€ æˆå‰¯ä½œç”¨ã€‚
*   **è‡ªåŠ¨æ„ˆåˆ (Auto-Healing)**ï¼šæµæ°´çº¿ä¼šæ ¹æ®é”™è¯¯æ—¥å¿—å’Œè§†è§‰åé¦ˆè‡ªåŠ¨é‡è¯•å¹¶è¿­ä»£å¤±è´¥çš„åœºæ™¯ã€‚
*   **å®Œæ•´ç”Ÿäº§**:
    *   **TTS é›†æˆ**: ä¸ºæ¯ä¸ªåœºæ™¯ç”Ÿæˆè¯­éŸ³æ—ç™½ã€‚
    *   **ç»„è£…å™¨ (Assembler)**: å°†ç”Ÿæˆçš„è§†é¢‘ç‰‡æ®µå’ŒéŸ³è½¨æ‹¼æ¥æˆæœ€ç»ˆç²¾ç¾çš„ `full_movie.mp4`ã€‚

## ğŸ› ï¸ å®‰è£…æŒ‡å—

### å‰ç½®è¦æ±‚
*   Python 3.10+
*   [Poetry](https://python-poetry.org/)
*   Docker (ç”¨äºå®‰å…¨æ¸²æŸ“)
*   FFmpeg (ç”¨äºè§†é¢‘ç»„è£…)

### è®¾ç½®

```bash
# 1. å…‹éš†ä»“åº“
git clone https://github.com/your-repo/markdown-to-video.git
cd markdown-to-video

# 2. å®‰è£…ä¾èµ–
poetry install

# 3. é…ç½®ç¯å¢ƒ
# å¤åˆ¶ç¤ºä¾‹ç¯å¢ƒæ–‡ä»¶å¹¶å¡«å…¥ä½ çš„ API Key (ä¾‹å¦‚ DashScope/OpenAI)
cp .env.example .env
```

## ğŸ“– ä½¿ç”¨æ–¹æ³•

### 1. åŸºç¡€ç”¨æ³•
ä½¿ç”¨ä½ çš„åˆ†é•œæ–‡ä»¶è¿è¡Œä¸»è„šæœ¬ï¼š

```bash
poetry run python src/main.py input/my_script.json
```

### 2. ä½¿ç”¨é‡å†™å™¨ (æ–‡æœ¬è½¬è§†é¢‘)
å¦‚æœä½ åªæœ‰ä¸€ä¸ªç²—ç•¥çš„æ–‡æœ¬è‰ç¨¿ï¼Œå¯ä»¥ä½¿ç”¨é‡å†™å™¨å…ˆç”Ÿæˆ JSONï¼š

```python
# (ä»£ç è°ƒç”¨ç¤ºä¾‹ - CLI å³å°†æ¨å‡º)
from src.components.rewriter import ScriptRewriter
rewriter = ScriptRewriter()
script = rewriter.rewrite("è§£é‡ŠäºŒåˆ†æŸ¥æ‰¾çš„æ¦‚å¿µï¼Œä½¿ç”¨è“è‰²çš„ç›’å­æ¼”ç¤ºã€‚")
```

### è¾“å…¥ JSON æ ¼å¼
```json
{
  "scenes": [
    {
      "scene_id": "01_intro",
      "description": "é¡¶éƒ¨å‡ºç°æ ‡é¢˜ 'äºŒåˆ†æŸ¥æ‰¾'ã€‚ä¸­é—´æ˜¾ç¤ºä¸€ä¸ªæ’åºå¥½çš„æ•°å­—æ•°ç»„ 1-10ã€‚",
      "duration": 5.0,
      "elements": ["æ ‡é¢˜", "æ’åºæ•°ç»„"],
      "audio_script": "äºŒåˆ†æŸ¥æ‰¾æ˜¯ä¸€ç§åœ¨æœ‰åºåˆ—è¡¨ä¸­æŸ¥æ‰¾é¡¹ç›®çš„ç®—æ³•ã€‚"
    }
  ]
}
```

## ğŸ—ï¸ æ¶æ„

ç³»ç»Ÿä½¿ç”¨ **StateGraph** æ¥ç®¡ç†åœºæ™¯çš„ç”Ÿå‘½å‘¨æœŸï¼š

```mermaid
graph TD
    Start --> Plan
    Plan --> Generate_Code
    Generate_Code --> Lint
    Lint -- Pass --> Render
    Lint -- Fail --> Fixer
    Render -- Success --> Critic
    Render -- Fail --> Fixer
    Critic -- Approved --> Finish
    Critic -- Rejected --> Fixer
    Fixer --> Generate_Code
```

## ğŸ“‚ é¡¹ç›®ç»“æ„

*   `src/main.py`: å…¥å£ç‚¹ã€‚
*   `src/core/graph.py`: LangGraph å®šä¹‰ (èŠ‚ç‚¹ä¸è¾¹)ã€‚
*   `src/components/`:
    *   `planner.py`: å¸ƒå±€ç­–ç•¥ã€‚
    *   `critic.py`: è§†è§‰è´¨é‡ä¿è¯ã€‚
    *   `renderer.py`: Docker äº¤äº’ã€‚
    *   `assembler.py`: FFmpeg ç¼–æ’ã€‚
*   `output/`: ç”Ÿæˆçš„äº§ç‰© (è§†é¢‘, è®¡åˆ’, è°ƒè¯•æ—¥å¿—)ã€‚

## ğŸŒ è¯­è¨€

*   [English](../README.md)
*   [ä¸­æ–‡ (Chinese)](README_cn.md)
